package agencia.view;

import agencia.controller.DadosController;
import agencia.model.*;
import javax.swing.*;
import javax.swing.border.*;
import javax.swing.table.DefaultTableModel;
import java.awt.*;
import java.util.List;

public class ClientesFrame extends JFrame { // cite: 2
    private final DadosController controller; // cite: 2
    private JTable table; // cite: 2
    private DefaultTableModel model; // cite: 2
    private List<Cliente> clientes; // cite: 3

    public ClientesFrame(DadosController controller) { // cite: 3
        this.controller = controller; // cite: 3
        initComponents(); // cite: 3
    } // cite: 4

    private void initComponents() { // cite: 4
        setTitle("Clientes"); // cite: 4
        setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE); // cite: 4

        // Painel principal com gradiente e borda
        JPanel mainPanel = new JPanel(new BorderLayout(10, 10)); // cite: 5
        mainPanel.setBorder(new CompoundBorder( // cite: 6
            new EmptyBorder(15, 15, 15, 15), // cite: 6
            new MatteBorder(1, 1, 1, 1, new Color(0x3f51b5)) // Linha de fora // cite: 6
        )); // cite: 6
        mainPanel.setBackground(new Color(0xDDA0DD)); // cite: 7

        // Título da janela
        JLabel titleLabel = new JLabel("Gerenciamento de Clientes"); // cite: 7
        titleLabel.setFont(new Font("Segoe UI", Font.BOLD, 18)); // cite: 8
        titleLabel.setForeground(new Color(0x3f51b5)); // cite: 8
        titleLabel.setBorder(new EmptyBorder(0, 0, 15, 0)); // cite: 8
        titleLabel.setHorizontalAlignment(SwingConstants.CENTER); // cite: 8
        mainPanel.add(titleLabel, BorderLayout.NORTH); // cite: 8

        String[] colunas = {"ID", "Nome", "Telefone", "Email", "Documento", "Tipo"}; // cite: 9
        model = new DefaultTableModel(colunas, 0) { // cite: 9
            @Override
            public boolean isCellEditable(int row, int column) {
                return false; // cite: 9
            } // cite: 10
        }; // cite: 10
        table = new JTable(model); // cite: 10
        configurarTabela(); // cite: 10

        // Painel da tabela com borda e sombra
        JPanel tablePanel = new JPanel(new BorderLayout()); // cite: 11
        tablePanel.setBorder(new CompoundBorder( // cite: 12
            new MatteBorder(1, 1, 1, 1, new Color(0xe0e0e0)), // cite: 12
            new EmptyBorder(5, 5, 5, 5) // cite: 12
        )); // cite: 12
        tablePanel.setBackground(Color.WHITE); // cite: 13
        tablePanel.add(new JScrollPane(table), BorderLayout.CENTER); // cite: 13
        mainPanel.add(tablePanel, BorderLayout.CENTER); // cite: 13

        // Painel de botões com estilo
        JPanel botoesPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 10, 10)); // cite: 13
        botoesPanel.setBorder(new EmptyBorder(10, 0, 0, 0)); // cite: 14
        botoesPanel.setBackground(new Color(0xDDA0DD)); // cite: 14
        
        JButton btnAdicionar = criarBotaoEstilizado("Adicionar", new Color(0xEEE8AA)); // cite: 14
        JButton btnEditar = criarBotaoEstilizado("Editar", new Color(0xFFFACD)); // cite: 14
        JButton btnExcluir = criarBotaoEstilizado("Excluir", new Color(0xFA8072)); // cite: 15
        JButton btnAtualizar = criarBotaoEstilizado("Atualizar", new Color(0xE0FFFF)); // cite: 15
        
        botoesPanel.add(btnAdicionar); // cite: 15
        botoesPanel.add(btnEditar); // cite: 15
        botoesPanel.add(btnExcluir); // cite: 15
        botoesPanel.add(btnAtualizar); // cite: 15
        mainPanel.add(botoesPanel, BorderLayout.SOUTH); // cite: 15

        btnAdicionar.addActionListener(e -> abrirDialogo(null)); // cite: 16
        btnEditar.addActionListener(e -> { // cite: 16
            int selectedRow = table.getSelectedRow(); // cite: 16
            if (selectedRow != -1) { // cite: 16
                abrirDialogo(clientes.get(table.convertRowIndexToModel(selectedRow))); // cite: 16
            } else { // cite: 16
                JOptionPane.showMessageDialog(this, "Selecione um cliente para editar.", "Aviso", JOptionPane.WARNING_MESSAGE); // cite: 16
            } // cite: 17
        }); // cite: 17
        btnExcluir.addActionListener(e -> excluirCliente()); // cite: 17
        btnAtualizar.addActionListener(e -> atualizarTabela()); // cite: 17

        setContentPane(mainPanel); // cite: 17
        pack(); // cite: 17
        atualizarTabela(); // cite: 17
    } // cite: 18

    private JButton criarBotaoEstilizado(String texto, Color cor) { // cite: 18
        JButton botao = new JButton(texto); // cite: 18
        botao.setFont(new Font("Segoe UI", Font.BOLD, 12)); // cite: 19
        botao.setBackground(cor); // cite: 19
        botao.setForeground(Color.WHITE); // cite: 19
        botao.setFocusPainted(false); // cite: 19
        botao.setBorder(new CompoundBorder( // cite: 19
            new MatteBorder(1, 1, 2, 1, cor.darker()), // cite: 19
            new EmptyBorder(5, 15, 5, 15) // cite: 19
        )); // cite: 19
        return botao; // cite: 20
    } // cite: 20

    private void configurarTabela() { // cite: 20
        table.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 21
        table.setRowHeight(28); // cite: 21
        table.getTableHeader().setFont(new Font("Segoe UI", Font.BOLD, 14)); // cite: 21
        table.getTableHeader().setBackground(new Color(0x3f51b5)); // cite: 21
        table.getTableHeader().setForeground(Color.WHITE); // cite: 21
        table.setSelectionMode(ListSelectionModel.SINGLE_SELECTION); // cite: 21
        table.setSelectionBackground(new Color(0xbbdefb)); // cite: 21
        table.setGridColor(new Color(0xe0e0e0)); // cite: 21
        table.setShowGrid(true); // cite: 21
    } // cite: 22

    private void atualizarTabela() { // cite: 22
        this.clientes = controller.carregarClientes(); // cite: 22
        model.setRowCount(0); // cite: 22
        for (Cliente c : this.clientes) { // cite: 23
            model.addRow(new Object[]{ c.getId(), c.getNome(), c.getTelefone(), c.getEmail(), c.getDocumento(), c.getTipo() }); // cite: 23
        } // cite: 24
    } // cite: 24

    private void excluirCliente() { // cite: 24
        int selectedRow = table.getSelectedRow(); // cite: 25
        if (selectedRow != -1) { // cite: 25
            Cliente cliente = clientes.get(table.convertRowIndexToModel(selectedRow)); // cite: 25
            int confirm = JOptionPane.showConfirmDialog(this, // cite: 26
                "Excluir o cliente '" + cliente.getNome() + "'?", // cite: 26
                "Confirmação", JOptionPane.YES_NO_OPTION); // cite: 26
            if (confirm == JOptionPane.YES_OPTION) { // cite: 27
                controller.excluirCliente(cliente.getId()); // cite: 27
                atualizarTabela(); // cite: 28
            } // cite: 28
        } else { // cite: 28
            JOptionPane.showMessageDialog(this, // cite: 28
                "Selecione um cliente para excluir.", // cite: 28
                "Aviso", JOptionPane.WARNING_MESSAGE); // cite: 28
        } // cite: 29
    } // cite: 29

    private void abrirDialogo(Cliente cliente) { // cite: 29
        boolean isEdit = cliente != null; // cite: 29
        JDialog dialog = new JDialog(this, isEdit ? "Editar Cliente" : "Novo Cliente", true); // cite: 30
        dialog.setSize(500, 350); // cite: 30
        dialog.setLayout(new BorderLayout()); // cite: 30
        dialog.setLocationRelativeTo(this); // cite: 30

        // Adicionando um painel de título
        JPanel titlePanel = new JPanel(); // cite: 31
        titlePanel.setBackground(new Color(0x3f51b5)); // cite: 31
        titlePanel.setBorder(new EmptyBorder(10, 15, 10, 15)); // cite: 32
        JLabel dialogTitle = new JLabel(isEdit ? "Editar Cliente" : "Novo Cliente"); // cite: 32
        dialogTitle.setFont(new Font("Segoe UI", Font.BOLD, 16)); // cite: 33
        dialogTitle.setForeground(Color.WHITE); // cite: 33
        titlePanel.add(dialogTitle); // cite: 33
        dialog.add(titlePanel, BorderLayout.NORTH); // cite: 33

        JPanel formPanel = new JPanel(new GridBagLayout()); // cite: 33
        formPanel.setBorder(new EmptyBorder(20, 20, 20, 20)); // cite: 34
        formPanel.setBackground(Color.WHITE); // cite: 34
        
        GridBagConstraints gbc = new GridBagConstraints(); // cite: 34
        gbc.insets = new Insets(5, 5, 5, 5); // cite: 34
        gbc.fill = GridBagConstraints.HORIZONTAL; // cite: 34

        // Nome - Label
        GridBagConstraints gbcLbl = new GridBagConstraints(); // cite: 35
        gbcLbl.gridx = 0; // cite: 36
        gbcLbl.gridy = 0; // cite: 36
        gbcLbl.weightx = 0; // cite: 36
        gbcLbl.anchor = GridBagConstraints.WEST; // cite: 36
        gbcLbl.insets = new Insets(5, 5, 5, 5); // cite: 36
        // margem opcional
        JLabel lblNome = new JLabel("Nome*:"); // cite: 37
        lblNome.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 37
        formPanel.add(lblNome, gbcLbl); // cite: 38

        // Nome - Campo de texto
        GridBagConstraints gbcTxt = new GridBagConstraints(); // cite: 38
        gbcTxt.gridx = 1; // cite: 39
        gbcTxt.gridy = 0; // cite: 39
        gbcTxt.weightx = 1; // cite: 39
        gbcTxt.fill = GridBagConstraints.HORIZONTAL; // cite: 39
        gbcTxt.insets = new Insets(5, 5, 5, 5); // cite: 39
        // margem opcional
        JTextField txtNome = new JTextField(isEdit ? cliente.getNome() : "", 20); // cite: 40
        txtNome.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 41
        txtNome.setBorder(new CompoundBorder( // cite: 41
            new MatteBorder(1, 1, 1, 1, new Color(0xe0e0e0)), // cite: 41
            new EmptyBorder(5, 5, 5, 5) // cite: 41
        )); // cite: 41
        formPanel.add(txtNome, gbcTxt); // cite: 42

     // Telefone - Label
        GridBagConstraints gbcLblTelefone = new GridBagConstraints(); // cite: 42
        gbcLblTelefone.gridx = 0; // cite: 43
        gbcLblTelefone.gridy = 1; // cite: 43
        gbcLblTelefone.weightx = 0; // cite: 43
        gbcLblTelefone.anchor = GridBagConstraints.WEST; // cite: 43
        gbcLblTelefone.insets = new Insets(5, 5, 5, 5); // cite: 43
        // margem opcional
        JLabel lblTelefone = new JLabel("Telefone*:"); // cite: 44
        lblTelefone.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 44
        formPanel.add(lblTelefone, gbcLblTelefone); // cite: 45

        // Telefone - Campo de texto
        GridBagConstraints gbcTxtTelefone = new GridBagConstraints(); // cite: 45
        gbcTxtTelefone.gridx = 1; // cite: 46
        gbcTxtTelefone.gridy = 1; // cite: 46
        gbcTxtTelefone.weightx = 1; // cite: 46
        gbcTxtTelefone.fill = GridBagConstraints.HORIZONTAL; // cite: 46
        gbcTxtTelefone.insets = new Insets(5, 5, 5, 5); // cite: 46
        // margem opcional
        JTextField txtTelefone = new JTextField(isEdit ? cliente.getTelefone() : "", 20); // cite: 47
        txtTelefone.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 48
        txtTelefone.setBorder(new CompoundBorder( // cite: 48
            new MatteBorder(1, 1, 1, 1, new Color(0xe0e0e0)), // cite: 48
            new EmptyBorder(5, 5, 5, 5) // cite: 48
        )); // cite: 48
        formPanel.add(txtTelefone, gbcTxtTelefone); // cite: 49

     // Email - Label
        GridBagConstraints gbcLblEmail = new GridBagConstraints(); // cite: 49
        gbcLblEmail.gridx = 0; // cite: 50
        gbcLblEmail.gridy = 2; // cite: 50
        gbcLblEmail.weightx = 0; // cite: 50
        gbcLblEmail.anchor = GridBagConstraints.WEST; // cite: 50
        gbcLblEmail.insets = new Insets(5, 5, 5, 5); // cite: 50
        JLabel lblEmail = new JLabel("Email*:"); // cite: 51
        lblEmail.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 51
        formPanel.add(lblEmail, gbcLblEmail); // cite: 51
        // Email - Campo de texto
        GridBagConstraints gbcTxtEmail = new GridBagConstraints(); // cite: 52
        gbcTxtEmail.gridx = 1; // cite: 53
        gbcTxtEmail.gridy = 2; // cite: 53
        gbcTxtEmail.weightx = 1; // cite: 53
        gbcTxtEmail.fill = GridBagConstraints.HORIZONTAL; // cite: 53
        gbcTxtEmail.insets = new Insets(5, 5, 5, 5); // cite: 53
        JTextField txtEmail = new JTextField(isEdit ? cliente.getEmail() : "", 20); // cite: 54
        txtEmail.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 55
        txtEmail.setBorder(new CompoundBorder( // cite: 55
            new MatteBorder(1, 1, 1, 1, new Color(0xe0e0e0)), // cite: 55
            new EmptyBorder(5, 5, 5, 5) // cite: 55
        )); // cite: 55
        formPanel.add(txtEmail, gbcTxtEmail); // cite: 56

     // Tipo - Label
        GridBagConstraints gbcLblTipo = new GridBagConstraints(); // cite: 56
        gbcLblTipo.gridx = 0; // cite: 57
        gbcLblTipo.gridy = 3; // cite: 57
        gbcLblTipo.weightx = 0; // cite: 57
        gbcLblTipo.anchor = GridBagConstraints.WEST; // cite: 57
        gbcLblTipo.insets = new Insets(5, 5, 5, 5); // cite: 57
        JLabel lblTipo = new JLabel("Tipo*:"); // cite: 58
        lblTipo.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 58
        formPanel.add(lblTipo, gbcLblTipo); // cite: 58
        // Tipo - ComboBox
        GridBagConstraints gbcCbTipo = new GridBagConstraints(); // cite: 59
        gbcCbTipo.gridx = 1; // cite: 60
        gbcCbTipo.gridy = 3; // cite: 60
        gbcCbTipo.weightx = 1; // cite: 60
        gbcCbTipo.fill = GridBagConstraints.HORIZONTAL; // cite: 60
        gbcCbTipo.insets = new Insets(5, 5, 5, 5); // cite: 60
        JComboBox<String> cbTipo = new JComboBox<>(new String[]{"NACIONAL", "ESTRANGEIRO"}); // cite: 61
        cbTipo.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 61
        cbTipo.setBackground(Color.WHITE); // cite: 61
        cbTipo.setBorder(new CompoundBorder( // cite: 62
            new MatteBorder(1, 1, 1, 1, new Color(0xe0e0e0)), // cite: 62
            new EmptyBorder(5, 5, 5, 5) // cite: 62
        )); // cite: 62
        if (isEdit) { // cite: 63
            cbTipo.setSelectedItem(cliente.getTipo()); // cite: 63
            cbTipo.setEnabled(false); // cite: 63
        } // cite: 64
        formPanel.add(cbTipo, gbcCbTipo); // cite: 64

        // Documento - Label
        GridBagConstraints gbcLblDocumento = new GridBagConstraints(); // cite: 65
        gbcLblDocumento.gridx = 0; // cite: 66
        gbcLblDocumento.gridy = 4; // cite: 66
        gbcLblDocumento.weightx = 0; // cite: 66
        gbcLblDocumento.anchor = GridBagConstraints.WEST; // cite: 66
        gbcLblDocumento.insets = new Insets(5, 5, 5, 5); // cite: 66
        JLabel lblDocumento = new JLabel("Documento*:"); // cite: 67
        lblDocumento.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 67
        formPanel.add(lblDocumento, gbcLblDocumento); // cite: 67
        // Documento - Campo de texto
        GridBagConstraints gbcTxtDocumento = new GridBagConstraints(); // cite: 68
        gbcTxtDocumento.gridx = 1; // cite: 69
        gbcTxtDocumento.gridy = 4; // cite: 69
        gbcTxtDocumento.weightx = 1; // cite: 69
        gbcTxtDocumento.fill = GridBagConstraints.HORIZONTAL; // cite: 69
        gbcTxtDocumento.insets = new Insets(5, 5, 5, 5); // cite: 69
        JTextField txtDocumento = new JTextField(isEdit ? cliente.getDocumento() : "", 20); // cite: 70
        txtDocumento.setFont(new Font("Segoe UI", Font.PLAIN, 14)); // cite: 71
        txtDocumento.setBorder(new CompoundBorder( // cite: 71
            new MatteBorder(1, 1, 1, 1, new Color(0xe0e0e0)), // cite: 71
            new EmptyBorder(5, 5, 5, 5) // cite: 71
        )); // cite: 71
        formPanel.add(txtDocumento, gbcTxtDocumento); // cite: 72

        JButton btnSalvar = criarBotaoEstilizado("Salvar", new Color(0x4caf50)); // cite: 72
        btnSalvar.addActionListener(e -> { // cite: 72
            // Lógica de validação e salvamento
        }); // cite: 72
        
        JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 10, 10)); // cite: 73
        buttonPanel.setBackground(Color.WHITE); // cite: 73
        buttonPanel.add(btnSalvar); // cite: 73

        dialog.add(formPanel, BorderLayout.CENTER); // cite: 73
        dialog.add(buttonPanel, BorderLayout.SOUTH); // cite: 73
        dialog.setVisible(true); // cite: 73
    } // cite: 73
}
